# nullvariant-justice[bot] - The code enforcer
# "ãƒ†ã‚¹ãƒˆã¯ï¼Ÿå‹å®šç¾©ã¯ï¼Ÿã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ï¼Ÿ"

name: ğŸ‘® Justice Bot

permissions: read-all

on:
  workflow_dispatch:
    inputs:
      message:
        description: 'What should Justice inspect? (optional)'
        required: false
        default: 'Code review in progress...'

jobs:
  justice-commit:
    name: ğŸ‘® Enforce the law
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ‘® Begin inspection
        run: |
          echo "âš–ï¸ JUSTICE HAS ARRIVED âš–ï¸"
          echo "Let me check your code quality..."
          echo "Tests? Types? Error handling?"

      - name: ğŸ”‘ Get App Token
        id: app-token
        uses: tibdex/github-app-token@v2
        with:
          app_id: ${{ secrets.JUSTICE_BOT_APP_ID }}
          private_key: ${{ secrets.JUSTICE_BOT_PRIVATE_KEY }}

      - name: ğŸ“¥ Checkout (for inspection)
        uses: actions/checkout@v4
        with:
          token: ${{ steps.app-token.outputs.token }}

      - name: ğŸ“ Leave a verdict
        run: |
          mkdir -p docs
          cat > docs/JUSTICE.md << EOF
          # ğŸ‘® Justice's Code Review

          > "The law applies equally to all code."

          ## Today's Verdict

          ${{ github.event.inputs.message }}

          ### Checklist
          - [ ] Tests written?
          - [ ] Types defined?
          - [ ] Errors handled?
          - [ ] Edge cases covered?

          ---

          *Last inspected: $(date -u +"%Y-%m-%d %H:%M:%S UTC")*

          > ãƒ†ã‚¹ãƒˆã¯ï¼Ÿå‹å®šç¾©ã¯ï¼Ÿã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ï¼Ÿ
          EOF

      - name: ğŸ“¬ Create PR with verified commit
        uses: peter-evans/create-pull-request@v7
        with:
          token: ${{ steps.app-token.outputs.token }}
          sign-commits: true
          author: nullvariant-justice[bot] <2610732+nullvariant-justice[bot]@users.noreply.github.com>
          committer: nullvariant-justice[bot] <2610732+nullvariant-justice[bot]@users.noreply.github.com>
          commit-message: |
            ğŸ‘® Code inspection complete

            ${{ github.event.inputs.message }}

            Remember: Tests? Types? Error handling?
          branch: justice/verdict-${{ github.run_number }}
          delete-branch: true
          title: "ğŸ‘® Justice's code review update"
          body: |
            ## ğŸ‘® âš–ï¸ VERDICT âš–ï¸

            ${{ github.event.inputs.message }}

            ---

            > ãƒ†ã‚¹ãƒˆã¯ï¼Ÿå‹å®šç¾©ã¯ï¼Ÿã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ï¼Ÿ

            *This PR was officially filed by nullvariant-justice[bot]*

      - name: âš–ï¸ Case closed
        run: |
          echo "Inspection complete."
          echo "Stay vigilant. Write tests."
          echo "âš–ï¸ JUSTICE NEVER SLEEPS âš–ï¸"
